#!/usr/bin/env node

var config = require('../src/config/config.js');

var path = require('path');

var argv = require('yargs').usage('Usage: $0 -x [num] -y [num]', {
  compile: {
      default: null
    , description: 'Run compile before building'
  },
  target: {
      default: null
    , description: 'Supporting web server software.  Currently only "node" is supported.'
  },
  o: {
      alias: 'output'
    , default: './dist'
    , description: 'Directory to store files'
  },
}).argv;

var build = require('../src/build/build-static.js');

function done(err, dist) {
  if (err) throw err;
  console.log('Done. Run: cd ./%s && npm install && npm start', path.relative(process.cwd(), dist));
  process.exit(0);
}

if (argv.compile) {
  require('./fancy-compile')(function() {
    build.start(argv, done);
  });
}
else {
  build.start(argv, done);
}
